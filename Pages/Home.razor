@page "/"
@using TodoApp.Client.Components
@using TodoApp.Client.Models
@inject IJSRuntime JS
@inject IHttpClientFactory ClientFactory

<RedirectToLogin />

<PageTitle>Home</PageTitle>

<h1>Hi @User?.Username, that's home page </h1>

Welcome to ToDo app.

<p style="margin-top: 8px"><a href="todos" style="margin-top: 16px">Visit ToDos page</a></p>

@code {
    private UserDto? User;

    protected override async Task OnInitializedAsync()
    {
        var client = ClientFactory.CreateClient("AuthorizedClient");
        var response = await client.GetAsync("api/users/current");
        if (!response.IsSuccessStatusCode)
            return;
        User = await response.Content.ReadFromJsonAsync<UserDto>();
    }
}